<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Student Management</h1>
            <a href="/new" class="add-btn" >
                + Add Student
            </a>
        </div>

        <!-- Filter Section -->
        <%- include("partials/filterForm") %>

        <div class="table-container">
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Grade Level</th>
                        <th>Average Grade</th>
                        <th>Strand</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                  <% students.forEach((student) => { %>
                    <tr id="row-<%= student.id %>">
                        <td><%= student.id %></td>
                        <td><%= student.first_name %></td>
                        <td><%= student.last_name %></td>
                        <td><%= student.grade_level %></td>
                        <td><%= student.grade_average %></td>
                        <td><%= student.strand %></td>
                    <td class="actions">
                        <a class="btn-edit" onclick="openEditModal('<%= student.id %>')">Edit</a>
                        <a class="btn-delete" href="/delete/<%= student.id %>">Delete</a>
                    </td>
                    </tr>
                  <% }); %>
                </tbody>
            </table>
        </div>

        <div class="summary" id="summary">
            <!-- Summary will be populated by JavaScript -->
        </div>

    </div>

    <script>
        function openEditModal(studentId) {
            const row = document.getElementById(`row-${studentId}`);
            const cells = row.querySelectorAll('td');
            // Populate modal fields
            document.getElementById('edit-id').value = cells[0].textContent.trim();
            document.getElementById('edit-first-name').value = cells[1].textContent.trim();
            document.getElementById('edit-last-name').value = cells[2].textContent.trim();
            document.getElementById('edit-grade-level').value = cells[3].textContent.trim();
            document.getElementById('edit-grade-average').value = cells[4].textContent.trim();
            document.getElementById('edit-strand').value = cells[5].textContent.trim();

            // Set form action
            document.getElementById('editStudentForm').action = `/update/${studentId}`;

            // Show modal
            document.getElementById('editModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        function clearFilters() {
            document.getElementById('searchName').value = '';
            document.getElementById('filterGradeLevel').value = '';
            document.getElementById('filterStrand').value = '';
            document.getElementById('filterGradeRange').value = '';
            
            // Here you would trigger the filter function to show all students again
            applyFilters();
        }
    </script>
</body>
</html>